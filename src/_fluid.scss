// ========================================
// dot-grid Fluid/Automatic Layouts
// ========================================
// Modern CSS Grid features that adapt automatically
// without explicit breakpoint classes

@use 'variables' as *;

@layer grid.fluid {

  // ========================================
  // Auto-responsive Grid (no breakpoints needed)
  // ========================================

  // Auto-fit: Fits as many columns as possible
  .grid-auto-fit {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(min(var(--grid-auto-min, 250px), 100%), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);
  }

  // Auto-fill: Fills the space with columns
  .grid-auto-fill {
    display: grid;
    grid-template-columns: repeat(
      auto-fill,
      minmax(min(var(--grid-auto-min, 250px), 100%), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);
  }

  // ========================================
  // Fluid Column Utilities
  // ========================================

  // Automatic column sizing
  .col-auto {
    grid-column: auto;
    width: auto;
  }

  // Fluid columns with minimum width
  .col-fluid {
    min-width: var(--col-min-width, 200px);
    flex: 1 1 var(--col-min-width, 200px);
  }

  // ========================================
  // Fluid Rows with Different Patterns
  // ========================================

  // Row that adapts to 2 columns on larger screens
  .row-fluid-2 {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(min(calc(50% - var(--grid-gap, #{$grid-gap-default}) / 2), 100%), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);
  }

  // Row that adapts to 3 columns on larger screens
  .row-fluid-3 {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(min(calc(33.333% - var(--grid-gap, #{$grid-gap-default}) * 2 / 3), 100%), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);
  }

  // Row that adapts to 4 columns on larger screens
  .row-fluid-4 {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(min(calc(25% - var(--grid-gap, #{$grid-gap-default}) * 3 / 4), 100%), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);
  }

  // ========================================
  // RAM (Repeat, Auto, Minmax) Pattern
  // ========================================
  // Automatically creates equal columns that wrap

  .row-ram {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(var(--col-min, 250px), 1fr)
    );
    gap: var(--grid-gap, $grid-gap-default);

    // Prevent children from having explicit column spans
    & > * {
      grid-column: auto !important;
    }
  }

  // ========================================
  // Intrinsic Sizing
  // ========================================

  // Columns size based on content
  .row-intrinsic {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(0, max-content));
    gap: var(--grid-gap, $grid-gap-default);
  }

  // Even columns that share space equally
  .row-even {
    display: grid;
    grid-auto-columns: 1fr;
    grid-auto-flow: column;
    gap: var(--grid-gap, $grid-gap-default);
  }

  // ========================================
  // Dense Packing
  // ========================================

  // Fills gaps in the grid (Pinterest/Masonry style)
  .row-dense {
    grid-auto-flow: dense;
  }

  // ========================================
  // Flexible Column Counts
  // ========================================
  // Override with CSS variables for custom fluid behavior

  .row-flexible {
    display: grid;
    grid-template-columns: repeat(
      auto-fit,
      minmax(
        clamp(
          var(--col-min, 200px),
          calc((100% - var(--grid-gap, #{$grid-gap-default}) * (var(--col-count, 3) - 1)) / var(--col-count, 3)),
          1fr
        ),
        1fr
      )
    );
    gap: var(--grid-gap, $grid-gap-default);
  }
}
